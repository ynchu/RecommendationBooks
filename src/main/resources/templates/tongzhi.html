<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" lang="zh">
<head>
  <meta charset="UTF-8">
  <title>广播通知</title>

  <!--[if lt IE 9]-->
  <script
    src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <!--[endif]-->

  <link rel="stylesheet" href="/resources/css/petclinic.css"/>
  <link rel="stylesheet" href="/resources/font/css/all.min.css"/>
</head>

<body>

<div class="container-fluid">
  <div class="container xd-container">

    <div id="app">
      <form class="form-horizontal" id="search-owner-form">
        <div class="form-group">
          <div class="control-group" id="lastNameGroup">
            <label class="col-sm-2 control-label">Last name </label>
            <div class="col-sm-5">
              <input class="form-control" size="30" maxlength="80"
                     v-model="lastName"/>
            </div>
            <div class="col-sm-2">
              <button class="btn btn-default" v-on:click.prevent="findOwners">Find Owner
              </button>
            </div>
          </div>
        </div>
        <div class="form-group"></div>
      </form>
      <hr>

      <table id="owners" class="table table-striped table-hover">
        <thead>
        <tr>
          <th>通知编辑人</th>
          <th>通知内容</th>
          <th>通知ID</th>
          <th>时间</th>
        </tr>
        </thead>
        <tbody>
        <tr v-for="owner in owners">
          <td v-text="owner.lastName"></td>
          <td v-text="owner.address"></td>
          <td v-text="owner.city"></td>
          <td v-text="owner.telephone"></td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


<script src="https://cdn.bootcss.com/vue/2.6.11/vue.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.19.2/axios.min.js"></script>
<script>
    var vue = new Vue({
        el: "#app",
        data: {
            lastName: "",
            owners: []
        },
        methods: {
            findOwners: function () {
                axios.get("https://localhost:8080/api/v1/broadcasts", {
                    params: {
                        lastName: this.lastName
                    }
                })
                    .then((e) => {
                        console.log(e.data);
                        this.owners = e.data;
                    }).catch((err) => {
                    console.log(err);
                });
            }
        }
    });
</script>
</body>
</html>